import pandas as pd
import re
from collections import Counter
from konlpy.tag import Okt

# --- í˜•íƒœì†Œ ë¶„ì„ê¸° ì´ˆê¸°í™” ---
okt = Okt()

# --- í‚¤ì›Œë“œ ì„¤ì • ---
sponsored_keywords = [
    # ê¸°ì¡´ í‚¤ì›Œë“œ
    "í˜‘ì°¬", "ì œê³µ", "ê´‘ê³ ", "ì²´í—˜ë‹¨", "ë¬´ë£Œ ì œê³µ", "ì„œí¬í„°ì¦ˆ", "í›„ì›", "ìŠ¤í°ì„œ", "ë¸Œëœë“œ ì§€ì›",
    "í™ë³´", "ì œí’ˆ ì œê³µ", "ì§€ì›ë°›ìŒ", "ì§€ì›ë°›ì€", "ë¬´ìƒ ì œê³µ", "ë¬´ìƒìœ¼ë¡œ ì œê³µ", "ì œê³µë°›ì€", "PPL", "ì§€ì›", "ì œí’ˆ ì„œí¬íŠ¸",
    "ë¸Œëœë“œ ì²´í—˜", "ë¸Œëœë“œ ì¸¡ì—ì„œ", "ì›ê³ ë£Œ", "ê´‘ê³ ì„±", "ì—…ì²´ ì œê³µ", "ê´‘ê³  í¬í•¨", "ê´‘ê³  ë¬¸êµ¬", "ê´‘ê³  í›„ê¸°",

    # âœ… í™•ì‹¤í•œ ê´‘ê³ /í˜‘ì°¬ í‘œí˜„ ì¶”ê°€
    "ì œí’ˆì„ ì œê³µë°›ì•„", "ë¸Œëœë“œë¡œë¶€í„°", "ê´‘ê³ ì£¼", "ê´‘ê³ ì„± ê¸€", "ì§€ì›ë°›ì•„ ì‘ì„±", "í˜‘ì°¬ë°›ì•„ ì‘ì„±", "ì œê³µë°›ì•„ ì‘ì„±",
    "ì´ í¬ìŠ¤íŒ…ì€", "ì´ ê¸€ì€", "í•´ë‹¹ ë¸Œëœë“œë¡œë¶€í„°", "ì œí’ˆì„ ë¬´ìƒìœ¼ë¡œ", "ì—…ì²´ë¡œë¶€í„°", "ì„œí¬íŠ¸ë¥¼ ë°›ìŒ", "ê´‘ê³  ì½˜í…ì¸ ",
    "ìœ ë£Œ ê´‘ê³  í¬í•¨", "ìœ ë£Œ í˜‘ì°¬ í¬í•¨", "ë³¸ ì œí’ˆì€", "ê´‘ê³  ëª©ì ", "PR ê¸€", "ê´‘ê³  í˜‘ì°¬", "ì œí’ˆ í˜‘ì°¬", "ë¸Œëœë“œ í˜‘ì°¬",
    "ì„œí¬í„°ì¦ˆ í™œë™", "ì œí’ˆì„ ë°›ì•„ë³´ê³ ", "ìŠ¤í°ì„œì‹­", "ë¸Œëœë“œì—ì„œ ë³´ë‚´ì¤€", "ë¸Œëœë“œì¸¡ì—ì„œ ì œê³µ", "ì œí’ˆ ë¦¬ë·° ìš”ì²­ì„ ë°›ì•„",
    "ì œì‘ ì§€ì›", "í™ë³´ìš©ìœ¼ë¡œ ì œê³µ", "ë§ˆì¼€íŒ… ëª©ì ", "ê´‘ê³ ìš©", "ê´‘ê³  ë¦¬ë·°", "ê´‘ê³  ê²Œì‹œ", "ê´‘ê³  ì•ˆë‚´", "ê´‘ê³  ë¬¸êµ¬ í¬í•¨"
]


positive_keywords = [
    # ê¸°ì¡´ í‚¤ì›Œë“œ í¬í•¨
    "ì¢‹ë‹¤", "ì¢‹ìŒ", "ì¢‹ì•„ìš”", "ì¢‹ìŠµë‹ˆë‹¤", "ì¢‹ë„¤ìš”", "ë„ˆë¬´ ì¢‹ë„¤ìš”", "ì°¸ ì¢‹ë„¤ìš”", "ê´œì°®ë‹¤", "ê´œì°®ë„¤ìš”",
    "ë§˜ì— ë“¤ì–´ìš”", "ë§ˆìŒì— ë“¤ì–´ìš”", "ëŒ€ë§Œì¡±", "ë§Œì¡±í•´ìš”", "ë§Œì¡±í•©ë‹ˆë‹¤", "ì•„ì£¼ ë§Œì¡±", "ì •ë§ ë§Œì¡±",
    "ì¶”ì²œ", "ì¶”ì²œí•©ë‹ˆë‹¤", "ì¶”ì²œë“œë ¤ìš”", "ì ê·¹ ì¶”ì²œ", "ê°•ë ¥ ì¶”ì²œ", "ì™„ì „ ì¶”ì²œ", "ê°•ì¶”", "ê°•ì¶”í•©ë‹ˆë‹¤",
    "ê·¹ì¶”ì²œ", "ì§„ì‹¬ ì¶”ì²œ", "ì§€ì¸ ì¶”ì²œ", "ì¬êµ¬ë§¤ ì˜ì‚¬", "ì¬êµ¬ë§¤ ì˜ˆì •", "ë˜ ì‚´ë˜ìš”", "í•œ ë²ˆ ë” êµ¬ë§¤",
    "ë‹¤ì‹œ ì‚¬ê³  ì‹¶ì–´ìš”", "ë˜ ì‚¬ê³  ì‹¶ì–´ìš”", "ì§„ì§œ ì¢‹ì•„ìš”", "ì •ë§ ì¢‹ì•„ìš”", "ì™„ì „ ì¢‹ì•„ìš”", "ì—„ì²­ ì¢‹ì•„ìš”", "ë„ˆë¬´ ì¢‹ì•„ìš”",
    "ìµœê³ ì˜ˆìš”", "ìµœê³ ì…ë‹ˆë‹¤", "ìµœê³ ë‹¤", "ìµœì• í…œ", "ì¸ìƒí…œ", "ì¸ìƒ í…œ", "ì°í…œ", "ì°í…œì´ì—ìš”", "ì—­ëŒ€ê¸‰", "ì—­ëŒ€ê¸‰ì´ì—ìš”", "ê°“í…œ",
    "ëŒ€ë°•í…œ", "ëŒ€ë°•ì´ì—ìš”", "ì™„ì „ ëŒ€ë°•", "ë¯¸ì¹œ ì œí’ˆ", "ë¯¸ì³¤ì–´ìš”", "ë¯¸ì¹œ í€„ë¦¬í‹°", "ì‹ ì˜ í•œ ìˆ˜", "ì‹ ì„¸ê³„",
    "ì™„ì „ ë§˜ì— ë“¤ì–´ìš”", "ê¸°ëŒ€ ì´ìƒ", "ê¸°ëŒ€í•œ ê²ƒ ì´ìƒ", "ì‚¬ê¸¸ ì˜í–ˆì–´ìš”", "í›„íšŒ ì—†ì–´ìš”", "ì§„ì§œ ë§Œì¡±í•´ìš”",
    "ì—†ìœ¼ë©´ ì•ˆ ë¼ìš”", "í•„ìˆ˜í…œ", "ì—†ìœ¼ë©´ í—ˆì „í•´ìš”", "í•˜ë‚˜ì¯¤ì€ ìˆì–´ì•¼ í•´ìš”", "ê³ ë¯¼í•˜ë‹¤ ìƒ€ëŠ”ë°", "ê³ ë¯¼í•  í•„ìš” ì—†ì–´ìš”",
    "ì‚¬ì„¸ìš”", "ê¼­ ì‚¬ì„¸ìš”", "í•„êµ¬í…œ", "ìˆìœ¼ë‹ˆê¹Œ ë„ˆë¬´ ì¢‹ì•„ìš”", "ë§¤ìš° ë§Œì¡±", "ë§Œì¡±ë„ ìµœê³ ", "ê°€ì„±ë¹„ ìµœê³ ",
    "í€„ë¦¬í‹° ë¯¸ì³¤ì–´ìš”", "êµ¬ë§¤ ê°•ì¶”", "ì™œ ì´ì œ ìƒ€ì„ê¹Œ", "ì‹ ì„¸ê³„ì—ìš”", "ì™„ì „ ì‚¬ë‘í•´ìš”", "ì™„ë²½í•´ìš”", "ì°¢ì—ˆì–´ìš”",

    # âœ… ì¶”ê°€ í‚¤ì›Œë“œ
    "ê¸°ëŒ€ ì´ìƒì´ì—ìš”", "ìƒê°ë³´ë‹¤ í›¨ì”¬ ì¢‹ì•„ìš”", "ì •ë§ ê´œì°®ë„¤ìš”", "ì§„ì§œ ê´œì°®ì•„ìš”", "ëŒ€ë°• ë§Œì¡±", "ì—­ì‹œ ë¯¿ê³  ì“°ëŠ”",
    "ë¯¿ê³  ì‚¬ëŠ”", "ë¯¿ê³  êµ¬ë§¤", "ë¯¿ê³  ì“°ëŠ”", "ë¯¿ê³  ì‚¬ìš©í•˜ëŠ”", "ì´ë²ˆì—ë„ ë§Œì¡±", "í•œ ë²ˆ ì¨ë³´ì„¸ìš”", "ë‘ê³ ë‘ê³  ì“¸ ê²ƒ ê°™ì•„ìš”",
    "ê¸°ëŠ¥ ì™„ë²½", "ë””ìì¸ ì˜ˆì¨", "ë””ìì¸ ë„ˆë¬´ ì˜ˆë»ìš”", "ê³ ê¸‰ìŠ¤ëŸ¬ì›€", "ê³ ê¸‰ì ¸ìš”", "ê³ ê¸‰ì ¸", "ê¹”ë”í•œ ë””ìì¸",
    "ê°ì„±í…œ", "ê°ì„± ìê·¹", "ì†Œì¥ ê°€ì¹˜ ìˆìŒ", "ë³´ëŠ” ìˆœê°„ ë°˜í•¨", "ê°–ê³  ì‹¶ë˜ ì•„ì´í…œ", "ê°–ê³  ì‹¶ì—ˆì–´ìš”", "ê³ ë¯¼í•  í•„ìš” ì—†ìŒ",
    "ì§„ì‘ ì‚´ê±¸", "ì•ˆ ìƒ€ìœ¼ë©´ í›„íšŒí–ˆì„ ë“¯", "ê°€ì„±ë¹„ ê°‘", "ê°€ì„±ë¹„ í‚¹", "ê°€ì„±ë¹„ ë¯¸ì³¤ì–´ìš”", "ê°€ì„±ë¹„ ë§Œì¡±", "ì´ ê°€ê²©ì— ì´ í€„ë¦¬í‹°?",
    "ëˆ ì•„ê¹ì§€ ì•ŠìŒ", "ëˆ ê°’í•¨", "ëˆì´ ì•„ê¹ì§€ ì•Šì•„ìš”", "ê°€ê²© ëŒ€ë¹„ í›Œë¥­", "ì„±ëŠ¥ ìµœê³ ", "ì„±ëŠ¥ ë¯¸ì³¤ì–´ìš”", "ì„±ëŠ¥ ë§Œì¡±",
    "ê°€ë²¼ì›Œì„œ ì¢‹ì•„ìš”", "í¸í•´ì„œ ì¢‹ì•„ìš”", "ì°©ìš©ê° ì¢‹ì•„ìš”", "ë¶€ë“œëŸ¬ì›Œìš”", "ì´‰ê° ì¢‹ì•„ìš”", "í–¥ê¸° ì¢‹ì•„ìš”", "í–¥ê¸° ë¯¸ì³¤ì–´ìš”",
    "ë””í…Œì¼ ì‚´ì•„ìˆìŒ", "ì„¬ì„¸í•˜ê²Œ ì˜ ë§Œë“ ", "ì •ì„± ê°€ë“", "ì„¸ì‹¬í•œ êµ¬ì„±", "ì„¼ìŠ¤ ìˆë‹¤", "ì„¼ìŠ¤ ë‹ë³´ì„", "ì„¼ìŠ¤ ìµœê³ ",
    "ì•„ì´ë””ì–´ ì¢‹ë‹¤", "ì´ëŸ° ì œí’ˆ ì²˜ìŒ ë´ìš”", "ìƒˆë¡­ê³  ì¢‹ì•„ìš”", "ì§€ê¸ˆê¹Œì§€ ì¤‘ ìµœê³ ", "ì—­ëŒ€ê¸‰ ë§Œì¡±", "ì¸ìƒí…œ ë°œê²¬",
    "í•˜ë£¨ì¢…ì¼ ë§Œì¡±", "ë§¤ì¼ ì“°ê³  ìˆì–´ìš”", "ë§¤ì¼ ì°¾ê²Œ ë¼ìš”", "ì—†ìœ¼ë©´ í—ˆì „í•¨", "ìƒí™œ í•„ìˆ˜í…œ", "ì‹¤ìš©ì„± ìµœê³ ", "ê¸°ëŠ¥ì„± êµ¿",
    "ê°„í¸í•´ì„œ ì¢‹ì•„ìš”", "ì •ë§ í¸ë¦¬", "ê°„í¸í•˜ê²Œ ì‚¬ìš©", "í™œìš©ë„ ë†’ìŒ", "í™œìš©ë„ ìµœê³ ", "ì—¬ëŸ¬ëª¨ë¡œ ìœ ìš©í•´ìš”", "ì—¬ëŸ¬ ê°œ ì‚¬ì•¼ í•´ìš”",
    "ê°€ì¡±ë“¤ë„ ë§Œì¡±", "ë¶€ëª¨ë‹˜ì´ ì¢‹ì•„í•˜ì‹¬", "ì¹œêµ¬ë„ ì‚¬ë‹¬ë¼ê³  í•¨", "ì£¼ë³€ì— ì¶”ì²œí•¨", "ì§€ì¸ë“¤ì—ê²Œ ì¶”ì²œí•¨", "ì£¼ë³€ ë°˜ì‘ ì¢‹ìŒ",
    "ì£¼ë³€ì—ì„œ ì˜ˆì˜ëŒ€ìš”", "ì£¼ë³€ì—ì„œ ë¬¼ì–´ë´„", "ì§€ì¸ë“¤ì—ê²Œ ì„ ë¬¼í•¨", "ì„ ë¬¼ìš©ìœ¼ë¡œë„ ìµœê³ ", "ì„ ë¬¼í–ˆë”ë‹ˆ ì¢‹ì•„í–ˆì–´ìš”",
    "í¬ì¥ë„ ì˜ˆì¨", "í¬ì¥ë„ ê³ ê¸‰ì§", "ë°°ì†¡ ë¹ ë¦„", "ë¹ ë¥¸ ë°°ì†¡ì— ë§Œì¡±", "ì •í™•í•œ ë°°ì†¡", "ì •í’ˆ ì¸ì¦", "ë¯¿ì„ ìˆ˜ ìˆëŠ” ì œí’ˆ",
    "ë¸Œëœë“œ ë¯¿ê³  êµ¬ë§¤", "AS ë§Œì¡±", "ê³ ê°ì‘ëŒ€ ì¢‹ìŒ", "ì¹œì ˆí•œ ì„œë¹„ìŠ¤", "ì¬êµ¬ë§¤ 100%", "ë˜ ì‚¬ê³  ì‹¶ìŒ", "ì—†ìœ¼ë©´ ì•ˆ ë  ë¬¼ê±´",
    "ìš”ì¦˜ ê°€ì¥ ì˜ ì“°ëŠ”", "ì´ë²ˆ ë‹¬ ë² ìŠ¤íŠ¸", "í‰ìƒí…œ", "ê³„ì† ì“°ê²Œ ë  ê²ƒ ê°™ì•„ìš”", "ë¦¬í•„ ê¼­ ì‚¬ì•¼ í•¨", "í•„ìˆ˜ êµ¬ë§¤ ì•„ì´í…œ"
]


price_keywords = [
    # --- ì¼ë°˜ ë‹¨ì–´ ---
    "ê°€ê²©", "ê°€ê²©ëŒ€", "ê°€ê²©í‘œ", "ì •ê°€", "í• ì¸ê°€", "íŠ¹ê°€", "ì„¸ì¼", "í• ì¸", "ì´ë²¤íŠ¸", "í”„ë¡œëª¨ì…˜",
    "ì €ë ´", "ì €ê°€", "ê³ ê°€", "ë¹„ìŒˆ", "ë¹„ì‹¸", "ê°€ì„±ë¹„", "í•©ë¦¬ì ", "ê°€ì„±ë¹„ ì¢‹ìŒ", "ì €ë ´í•œ", "ì €ë ´í•˜ê²Œ",
    "ê°€ì„±ë¹„ ìˆëŠ”", "ê°€ê²© ëŒ€ë¹„", "ê°€ì¹˜ ìˆëŠ” ê°€ê²©", "ê°€ê²© ë§Œì¡±", "ê°€ê²© ë§Œì¡±ë„", "ì°©í•œ ê°€ê²©", "í˜œì", "í˜œìí…œ",
    "ì ë‹¹í•œ ê°€ê²©", "ê°€ê²© ê´œì°®ìŒ", "ê°€ê²© ì°©í•´ìš”", "ê°€ê²©ì´ ì°©í•˜ë‹¤", "ë¹„ìš© ë¶€ë‹´ ì—†ìŒ", "ë¶€ë‹´ ì—†ëŠ” ê°€ê²©", "ê°€ê²© ê²½ìŸë ¥",

    # --- ìˆ«ì + ë‹¨ìœ„ í‘œí˜„ ---
    "ë§Œì›", "ë§Œ ì›", "ì›", "ì›ëŒ€", "ì²œì›", "ì²œ ì›", "1ë§Œ ì›", "1ë§Œì›", "10,000ì›", "10000ì›",
    "5ì²œì›", "ì˜¤ì²œì›", "ì˜¤ì²œ ì›", "1ë§Œì›ëŒ€", "2ë§Œì›ëŒ€", "3ë§Œì›ëŒ€", "4ë§Œì›ëŒ€", "5ë§Œì›ëŒ€", "10ë§Œì›ëŒ€",
    "ëª‡ ì²œì›", "ëª‡ ë§Œì›", "1~2ë§Œì›", "2~3ë§Œì›", "3~4ë§Œì›", "1ë§Œì› ì´í•˜", "1ë§Œì› ë¯¸ë§Œ", "5ì²œì› ì´í•˜", "ë¬´ë£Œ",

    # --- ì€ì–´/ì‹ ì¡°ì–´/ê°íƒ„í˜• ---
    "ê°€ì„±ë¹„ ë¯¸ì³¤ë‹¤", "í˜œììŠ¤ëŸ¬ìš´", "ì •ì‹  ëª» ì°¨ë¦¬ëŠ” ê°€ê²©", "ë§ë„ ì•ˆ ë˜ëŠ” ê°€ê²©", "ì°ìœ¼ë¡œ ì‹¸ë‹¤", "ì° í˜œì", "ê°€ê²© ë¯¸ì¹¨",
    "ë„ˆë¬´ ì‹¸ë‹¤", "ê·¸ ê°€ê²©ì— ì´ ì •ë„?", "ëˆê°’í•¨", "ì´ê²Œ ì´ ê°€ê²©?", "ì´ ê°€ê²© ì‹¤í™”?", "ì´ ê°€ê²©ì´ë©´ ë¬´ì¡°ê±´ ì‚¬ì•¼", "ê°€ê²© ë¯¸ì³¤ì–´ìš”",
    "ì´ ì •ë„ í€„ë¦¬í‹°ì— ì´ ê°€ê²©?", "ê°€ê²© ë“£ê³  ë†€ëŒ", "ê°€ê²© ë³´ê³  ê¹œì§", "ê±°ì˜ ê³µì§œ", "ê±°ì € ì¤Œ", "ë¯¸ì¹œ ê°€ì„±ë¹„", "í˜œì ê°€ê²©", "ê°€ê²© ì‹¤í™”ëƒ"
]


shopping_mall_domains = ["smartstore.naver.com", "musinsa.com", "coupang.com", "gmarket.co.kr", "11st.co.kr", "link.coupang"]


negation_patterns = [
    # ê´‘ê³ /í˜‘ì°¬ ë“±ì˜ ë¶€ì • í‘œí˜„
    r"(ê´‘ê³ |í˜‘ì°¬|ìŠ¤í°ì„œ|ì§€ì›|ì²´í—˜ë‹¨)\s*(?:ì„|ë¥¼)?\s*(?:ì „í˜€|ì¼ì ˆ|ì¼ì²´)?\s*(ë°›ì§€\s*ì•Š|ì•ˆ\s*ë°›|ì•Šì•˜|ë°›ì€\s*ì \s*ì—†|ì—†ì–´ìš”|ì—†ìŠµë‹ˆë‹¤|ì•„ë‹™ë‹ˆë‹¤|ì•„ë‹ˆì—ìš”|ì•ˆ\s*í–ˆ|ì—†ì—ˆ|ì•„ë‹˜|ì•„ë…€)",

    # ìë¹„ êµ¬ë§¤ í‘œí˜„ (ë‚´ëˆë‚´ì‚°/ì§ì ‘ êµ¬ë§¤ ê³„ì—´)
    r"(ë‚´\s*ëˆ\s*ë‚´\s*ì‚°|ë‚´ëˆë‚´ì‚°|ë³¸ì¸\s*êµ¬ë§¤|ìë¹„ë¡œ\s*êµ¬ë§¤|ì§ì ‘\s*êµ¬ë§¤|ë‚´\s*ëˆ\s*ì£¼ê³ \s*ìƒ€|ë‚´\s*ëˆ\s*ìœ¼ë¡œ\s*ì§ì ‘\s*êµ¬ë§¤|ì‚¬ë¹„ë¡œ\s*êµ¬ë§¤|ì§ì ‘\s*ê²°ì œ|ìì²´\s*êµ¬ë§¤|ë‚´\s*ëˆ\s*ì§€ë¶ˆ)",

    # ì˜ì–´ ë¶€ì • í‘œí˜„
    r"(no|not|without|zero)\s*(sponsor|sponsorship|ad|advertisement|promotion|support)",

    # ë‹¨ì–´í˜• ë¶€ì • í‘œí˜„
    r"(ë¬´\s*ê´‘ê³ |ë¹„\s*ê´‘ê³ |ë¹„\s*í˜‘ì°¬|ë¬´\s*í˜‘ì°¬|ì–¸\s*ìŠ¤í°ì„œ|ë…¸\s*ìŠ¤í°ì„œ|ë¹„\s*ìŠ¤í°ì„œ|ë…¸\s*ê´‘ê³ |ë…¸\s*í˜‘ì°¬)",

    # ë¦¬ë·° ì „ì²´ë¥¼ ë¶€ì •í•˜ëŠ” ê´€ìš©í˜•
    r"(ê´‘ê³ \s*ì•„ë‹ˆì—ìš”|í˜‘ì°¬\s*ì•„ë‹™ë‹ˆë‹¤|ì´ê±´\s*ê´‘ê³ \s*ì•„ë‹˜|ì´ê±´\s*í˜‘ì°¬\s*ì•„ë‹˜|ìŠ¤í°ì„œ\s*ì•„ë‹™ë‹ˆë‹¤|í˜‘ì°¬\s*ì—†ì´\s*êµ¬ë§¤)",

    # "ë‚´ëˆë‚´ì‚°" ê°•ì¡° ë¬¸ì¥ êµ¬ì¡°
    r"(ì •ë§\s*ë‚´ëˆë‚´ì‚°|100%\s*ë‚´ëˆë‚´ì‚°|ë‚´\s*ëˆ\s*ì£¼ê³ \s*êµ¬ë§¤|ê´‘ê³ \s*ì ˆëŒ€\s*ì•„ë‹˜|ì§„ì§œ\s*ë‚´ëˆë‚´ì‚°)"
]






def is_negated_keyword(text, keyword):
    for pattern in negation_patterns:
        if re.search(pattern, text) and keyword in pattern:
            return True
    return False


def morph_sequence_in_text(morph_sequence, morphs):
    for i in range(len(morphs) - len(morph_sequence) + 1):
        if morphs[i:i+len(morph_sequence)] == morph_sequence:
            return True
    return False


def count_keywords_morph(text, keywords):
    text = str(text)
    morphs = okt.morphs(text)
    count = 0
    for kw in keywords:
        if is_negated_keyword(text, kw):
            continue  # ë¶€ì • í‘œí˜„ì¸ ê²½ìš° ìŠ¤í‚µ
        kw_morphs = okt.morphs(kw)  # í‚¤ì›Œë“œ í˜•íƒœì†Œë¡œ ë³€í™˜
        if morph_sequence_in_text(kw_morphs, morphs):
            count += 1
    return count


def count_external_links(text):
    text = str(text)
    url_pattern = r'((https?:\/\/)?(www\.)?[\w\-]+\.(com|co\.kr|kr|net|org|shop|me|info|biz|tv|store)(\/\S*)?)'
    return len(re.findall(url_pattern, text))



def has_shopping_mall_link(text):
    return int(any(domain in text for domain in shopping_mall_domains))


def count_most_common_word_freq_ratio(text):
    stopwords = {"ì´", "ê·¸", "ì €", "ê²ƒ", "ìˆ˜", "ë“±", "ë”", "ë˜", "ì¢€", "ë“¯", "ê²Œ",
                 "ì „", "í›„", "ê¹Œì§€", "ë§Œ", "ì—ì„œ", "ìœ¼ë¡œ", "í•˜ê³ ", "ì—ê²Œ", "ë³´ë‹¤",
                 "ë„ˆë¬´", "ì§„ì§œ", "ì •ë§", "ì•„ì£¼", "ë§¤ìš°", "í•´ì„œ", "í•´ì„œìš”"}

    words = [w for w in str(text).split() if w not in stopwords and len(w) > 1]

    if not words:
        return 0

    word_counts = Counter(words)
    most_common = word_counts.most_common(1)[0][1]

    return most_common / len(words)


def adj_adv_ratio(text):
    pos_tags = okt.pos(str(text))
    if not pos_tags:
        return 0
    count = sum(1 for word, tag in pos_tags if tag in ["Adjective", "Adverb"])
    return count / len(pos_tags)


def emoji_count(text):
    return len(re.findall(r"[ğŸ˜€ğŸ˜ğŸ˜‚ğŸ¤£ğŸ˜ƒğŸ˜„ğŸ˜…ğŸ˜†ğŸ˜‰ğŸ˜ŠğŸ˜‹ğŸ˜ğŸ˜ğŸ˜˜ğŸ¥°ğŸ˜—ğŸ˜™ğŸ˜šâ˜ºğŸ™‚ğŸ¤—ğŸ¤©ğŸ¤”ğŸ¤¨ğŸ˜ğŸ˜‘ğŸ˜¶ğŸ™„ğŸ˜ğŸ˜£ğŸ˜¥ğŸ˜®ğŸ¤ğŸ˜¯ğŸ˜ªğŸ˜«ğŸ˜´ğŸ˜ŒğŸ˜›ğŸ˜œğŸ˜ğŸ¤¤ğŸ˜’ğŸ˜“ğŸ˜”ğŸ˜•ğŸ™ƒğŸ¤‘ğŸ˜²â˜¹ğŸ™ğŸ˜–ğŸ˜ğŸ˜ŸğŸ˜¤ğŸ˜¢ğŸ˜­ğŸ˜¦ğŸ˜§ğŸ˜¨ğŸ˜©ğŸ¤¯ğŸ˜¬ğŸ˜°ğŸ˜±ğŸ¥µğŸ¥¶ğŸ˜³ğŸ¤ªğŸ˜µğŸ˜¡ğŸ˜ ğŸ¤¬ğŸ˜·ğŸ¤’ğŸ¤•ğŸ¤¢ğŸ¤®ğŸ¤§ğŸ˜‡ğŸ¤ ğŸ¥³ğŸ¥´ğŸ¥ºğŸ¤¥ğŸ¤«ğŸ¤­ğŸ§ğŸ¤“ğŸ˜ˆğŸ‘¿ğŸ¤¡ğŸ‘¹ğŸ‘ºğŸ’€â˜ ğŸ‘»ğŸ‘½ğŸ‘¾ğŸ¤–ğŸ’©ğŸ˜ºğŸ˜¸ğŸ˜¹ğŸ˜»ğŸ˜¼ğŸ˜½ğŸ™€ğŸ˜¿ğŸ˜¾ğŸ™ˆğŸ™‰ğŸ™ŠğŸ‘¶ğŸ§’ğŸ‘¦ğŸ‘§ğŸ§‘ğŸ‘±ğŸ‘¨ğŸ‘±â€â™‚ğŸ§”ğŸ‘©ğŸ‘±â€â™€ğŸ§“ğŸ‘´ğŸ‘µğŸ‘¨â€âš•ğŸ‘©â€âš•ğŸ‘¨â€ğŸ“ğŸ‘©â€ğŸ“ğŸ‘¨â€ğŸ«ğŸ‘©â€ğŸ«ğŸ‘¨â€âš–ğŸ‘©â€âš–ğŸ‘¨â€ğŸŒ¾ğŸ‘©â€ğŸŒ¾ğŸ‘¨â€ğŸ³ğŸ‘©â€ğŸ³ğŸ‘¨â€ğŸ”§ğŸ‘©â€ğŸ”§ğŸ‘¨â€ğŸ­ğŸ‘©â€ğŸ­ğŸ‘¨â€ğŸ’¼ğŸ‘©â€ğŸ’¼ğŸ‘¨â€ğŸ”¬ğŸ‘©â€ğŸ”¬ğŸ‘¨â€ğŸ’»ğŸ‘©â€ğŸ’»ğŸ‘¨â€ğŸ¤ğŸ‘©â€ğŸ¤ğŸ‘¨â€ğŸ¨ğŸ‘©â€ğŸ¨ğŸ‘¨â€âœˆğŸ‘©â€âœˆğŸ‘¨â€ğŸš€ğŸ‘©â€ğŸš€ğŸ‘¨â€ğŸš’ğŸ‘©â€ğŸš’ğŸ‘®ğŸ‘®â€â™‚ğŸ‘®â€â™€ğŸ•µğŸ•µâ€â™‚ğŸ•µâ€â™€ğŸ’‚ğŸ’‚â€â™‚ğŸ’‚â€â™€ğŸ‘·ğŸ‘·â€â™‚ğŸ‘·â€â™€ğŸ¤´ğŸ‘¸ğŸ‘³ğŸ‘³â€â™‚ğŸ‘³â€â™€ğŸ‘²ğŸ§•ğŸ¤µğŸ‘°ğŸ¤°ğŸ¤±ğŸ‘¼ğŸ…ğŸ¤¶ğŸ¦¸ğŸ¦¸â€â™€ğŸ¦¸â€â™‚ğŸ¦¹ğŸ¦¹â€â™€ğŸ¦¹â€â™‚ğŸ§™ğŸ§™â€â™€ğŸ§™â€â™‚ğŸ§šğŸ§šâ€â™€ğŸ§šâ€â™‚ğŸ§›ğŸ§›â€â™€ğŸ§›â€â™‚ğŸ§œğŸ§œâ€â™€ğŸ§œâ€â™‚ğŸ§ğŸ§â€â™€ğŸ§â€â™‚ğŸ§ğŸ§â€â™€ğŸ§â€â™‚ğŸ§ŸğŸ§Ÿâ€â™€ğŸ§Ÿâ€â™‚ğŸ™ğŸ™â€â™‚ğŸ™â€â™€ğŸ™ğŸ™â€â™‚ğŸ™â€â™€ğŸ™…ğŸ™…â€â™‚ğŸ™…â€â™€ğŸ™†ğŸ™†â€â™‚ğŸ™†â€â™€ğŸ’ğŸ’â€â™‚ğŸ’â€â™€ğŸ™‹ğŸ™‹â€â™‚ğŸ™‹â€â™€ğŸ™‡ğŸ™‡â€â™‚ğŸ™‡â€â™€ğŸ¤¦ğŸ¤¦â€â™‚ğŸ¤¦â€â™€ğŸ¤·ğŸ¤·â€â™‚ğŸ¤·â€â™€ğŸ’†ğŸ’†â€â™‚ğŸ’†â€â™€ğŸ’‡ğŸ’‡â€â™‚ğŸ’‡â€â™€ğŸš¶ğŸš¶â€â™‚ğŸš¶â€â™€ğŸƒğŸƒâ€â™‚ğŸƒâ€â™€ğŸ’ƒğŸ•ºğŸ‘¯ğŸ‘¯â€â™‚ğŸ‘¯â€â™€ğŸ§–ğŸ§–â€â™€ğŸ§–â€â™‚ğŸ§—ğŸ§—â€â™€ğŸ§—â€â™‚ğŸ§˜ğŸ§˜â€â™€ğŸ§˜â€â™‚ğŸ›€ğŸ›ŒğŸ•´ğŸ—£ğŸ‘¤ğŸ‘¥ğŸ¤ºğŸ‡â›·ğŸ‚ğŸŒğŸŒâ€â™‚ğŸŒâ€â™€ğŸ„ğŸ„â€â™‚ğŸ„â€â™€ğŸš£ğŸš£â€â™‚ğŸš£â€â™€ğŸŠğŸŠâ€â™‚ğŸŠâ€â™€â›¹â›¹â€â™‚â›¹â€â™€ğŸ‹ğŸ‹â€â™‚ğŸ‹â€â™€ğŸš´ğŸš´â€â™‚ğŸš´â€â™€ğŸšµğŸšµâ€â™‚ğŸšµâ€â™€ğŸğŸğŸ¤¸ğŸ¤¸â€â™‚ğŸ¤¸â€â™€ğŸ¤¼ğŸ¤¼â€â™‚ğŸ¤¼â€â™€ğŸ¤½ğŸ¤½â€â™‚ğŸ¤½â€â™€ğŸ¤¾ğŸ¤¾â€â™‚ğŸ¤¾â€â™€ğŸ¤¹ğŸ¤¹â€â™‚ğŸ¤¹â€â™€ğŸ‘«ğŸ‘¬ğŸ‘­ğŸ’ğŸ’‘ğŸ‘ªğŸ¤³ğŸ’ªğŸ¦µğŸ¦¶ğŸ‘ˆğŸ‘‰â˜ğŸ‘†ğŸ–•ğŸ‘‡âœŒğŸ¤ğŸ––ğŸ¤˜ğŸ¤™ğŸ–âœ‹ğŸ‘ŒğŸ‘ğŸ‘âœŠğŸ‘ŠğŸ¤›ğŸ¤œğŸ¤šğŸ‘‹ğŸ¤ŸâœğŸ‘ğŸ‘ğŸ™ŒğŸ¤²ğŸ™ğŸ¤ğŸ’…ğŸ‘‚ğŸ‘ƒğŸ‘£ğŸ‘€ğŸ‘ğŸ‘â€ğŸ—¨ğŸ§ ğŸ¦´ğŸ¦·ğŸ‘…ğŸ‘„ğŸ¦°ğŸ¦±ğŸ¦³ğŸ¦²ğŸ’‹ğŸ’˜ğŸ’ğŸ’–ğŸ’—ğŸ’“ğŸ’ğŸ’•ğŸ’Œâ£ğŸ’”â¤ğŸ§¡ğŸ’›ğŸ’šğŸ’™ğŸ’œğŸ–¤ğŸ’ŸğŸ’¤ğŸ’¢ğŸ’£ğŸ’¥ğŸ’¦ğŸ’¨ğŸ’«ğŸ’¬ğŸ—¨ğŸ—¯ğŸ’­ğŸ•³ğŸ‘“ğŸ•¶ğŸ¥½ğŸ¥¼ğŸ‘”ğŸ‘•ğŸ‘–ğŸ§£ğŸ§¤ğŸ§¥ğŸ§¦ğŸ‘—ğŸ‘˜ğŸ‘™ğŸ‘šğŸ‘›ğŸ‘œğŸ‘ğŸ›ğŸ’ğŸ‘ğŸ‘ŸğŸ¥¾ğŸ¥¿ğŸ‘ ğŸ‘¡ğŸ‘¢ğŸ‘‘ğŸ‘’ğŸ©ğŸ“ğŸ§¢â›‘ğŸ“¿ğŸ’„ğŸ’ğŸ’ğŸµğŸ’ğŸ¦ğŸ¶ğŸ•ğŸ©ğŸºğŸ¦ŠğŸ¦ğŸ±ğŸˆğŸ¦ğŸ¯ğŸ…ğŸ†ğŸ´ğŸğŸ¦„ğŸ¦“ğŸ¦ŒğŸ®ğŸ‚ğŸƒğŸ„ğŸ·ğŸ–ğŸ—ğŸ½ğŸğŸ‘ğŸğŸªğŸ«ğŸ¦™ğŸ¦’ğŸ˜ğŸ¦ğŸ¦›ğŸ­ğŸğŸ€ğŸ¹ğŸ°ğŸ‡ğŸ¿ğŸ¦”ğŸ¦‡ğŸ»ğŸ¨ğŸ¼ğŸ¦˜ğŸ¦¡ğŸ¾ğŸ¦ƒğŸ”ğŸ“ğŸ£ğŸ¤ğŸ¥ğŸ¦ğŸ§ğŸ•ŠğŸ¦…ğŸ¦†ğŸ¦¢ğŸ¦‰ğŸ¦šğŸ¦œğŸ¸ğŸŠğŸ¢ğŸ¦ğŸğŸ²ğŸ‰ğŸ¦•ğŸ¦–ğŸ³ğŸ‹ğŸ¬ğŸŸğŸ ğŸ¡ğŸ¦ˆğŸ™ğŸšğŸ¦€ğŸ¦ğŸ¦ğŸ¦‘ğŸŒğŸ¦‹ğŸ›ğŸœğŸğŸğŸ¦—ğŸ•·ğŸ•¸ğŸ¦‚ğŸ¦ŸğŸ¦ ğŸ’ğŸŒ¸ğŸ’®ğŸµğŸŒ¹ğŸ¥€ğŸŒºğŸŒ»ğŸŒ¼ğŸŒ·ğŸŒ±ğŸŒ²ğŸŒ³ğŸŒ´ğŸŒµğŸŒ¾ğŸŒ¿â˜˜ğŸ€ğŸğŸ‚ğŸƒğŸ‡ğŸˆğŸ‰ğŸŠğŸ‹ğŸŒğŸğŸ¥­ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ¥ğŸ…ğŸ¥¥ğŸ¥‘ğŸ†ğŸ¥”ğŸ¥•ğŸŒ½ğŸŒ¶ğŸ¥’ğŸ¥¬ğŸ¥¦ğŸ„ğŸ¥œğŸŒ°ğŸğŸ¥ğŸ¥–ğŸ¥¨ğŸ¥¯ğŸ¥ğŸ§€ğŸ–ğŸ—ğŸ¥©ğŸ¥“ğŸ”ğŸŸğŸ•ğŸŒ­ğŸ¥ªğŸŒ®ğŸŒ¯ğŸ¥™ğŸ¥šğŸ³ğŸ¥˜ğŸ²ğŸ¥£ğŸ¥—ğŸ¿ğŸ§‚ğŸ¥«ğŸ±ğŸ˜ğŸ™ğŸšğŸ›ğŸœğŸğŸ ğŸ¢ğŸ£ğŸ¤ğŸ¥ğŸ¥®ğŸ¡ğŸ¥ŸğŸ¥ ğŸ¥¡ğŸ¦ğŸ§ğŸ¨ğŸ©ğŸªğŸ‚ğŸ°ğŸ§ğŸ¥§ğŸ«ğŸ¬ğŸ­ğŸ®ğŸ¯ğŸ¼ğŸ¥›â˜•ğŸµğŸ¶ğŸ¾ğŸ·ğŸ¸ğŸ¹ğŸºğŸ»ğŸ¥‚ğŸ¥ƒğŸ¥¤ğŸ¥¢ğŸ½ğŸ´ğŸ¥„ğŸ”ªğŸºğŸŒğŸŒğŸŒğŸŒğŸ—ºğŸ—¾ğŸ§­ğŸ”â›°ğŸŒ‹ğŸ—»ğŸ•ğŸ–ğŸœğŸğŸğŸŸğŸ›ğŸ—ğŸ§±ğŸ˜ğŸšğŸ ğŸ¡ğŸ¢ğŸ£ğŸ¤ğŸ¥ğŸ¦ğŸ¨ğŸ©ğŸªğŸ«ğŸ¬ğŸ­ğŸ¯ğŸ°ğŸ’’ğŸ—¼ğŸ—½â›ªğŸ•ŒğŸ•â›©ğŸ•‹â›²â›ºğŸŒğŸŒƒğŸ™ğŸŒ„ğŸŒ…ğŸŒ†ğŸŒ‡ğŸŒ‰â™¨ğŸŒŒğŸ ğŸ¡ğŸ¢ğŸ’ˆğŸªğŸš‚ğŸšƒğŸš„ğŸš…ğŸš†ğŸš‡ğŸšˆğŸš‰ğŸšŠğŸšğŸšğŸš‹ğŸšŒğŸšğŸšğŸšğŸš‘ğŸš’ğŸš“ğŸš”ğŸš•ğŸš–ğŸš—ğŸš˜ğŸš™ğŸššğŸš›ğŸšœğŸš²ğŸ›´ğŸ›¹ğŸ›µğŸšğŸ›£ğŸ›¤ğŸ›¢â›½ğŸš¨ğŸš¥ğŸš¦ğŸ›‘ğŸš§âš“â›µğŸ›¶ğŸš¤ğŸ›³â›´ğŸ›¥ğŸš¢âœˆğŸ›©ğŸ›«ğŸ›¬ğŸ’ºğŸšğŸšŸğŸš ğŸš¡ğŸ›°ğŸš€ğŸ›¸ğŸ›ğŸ§³âŒ›â³âŒšâ°â±â²ğŸ•°ğŸ•›ğŸ•§ğŸ•ğŸ•œğŸ•‘ğŸ•ğŸ•’ğŸ•ğŸ•“ğŸ•ŸğŸ•”ğŸ• ğŸ••ğŸ•¡ğŸ•–ğŸ•¢ğŸ•—ğŸ•£ğŸ•˜ğŸ•¤ğŸ•™ğŸ•¥ğŸ•šğŸ•¦ğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜ğŸŒ™ğŸŒšğŸŒ›ğŸŒœğŸŒ¡â˜€ğŸŒğŸŒâ­ğŸŒŸğŸŒ â˜â›…â›ˆğŸŒ¤ğŸŒ¥ğŸŒ¦ğŸŒ§ğŸŒ¨ğŸŒ©ğŸŒªğŸŒ«ğŸŒ¬ğŸŒ€ğŸŒˆğŸŒ‚â˜‚â˜”â›±âš¡â„â˜ƒâ›„â˜„ğŸ”¥ğŸ’§ğŸŒŠğŸƒğŸ„ğŸ†ğŸ‡ğŸ§¨âœ¨ğŸˆğŸ‰ğŸŠğŸ‹ğŸğŸğŸğŸğŸ‘ğŸ§§ğŸ€ğŸğŸ—ğŸŸğŸ«ğŸ–ğŸ†ğŸ…ğŸ¥‡ğŸ¥ˆğŸ¥‰âš½âš¾ğŸ¥ğŸ€ğŸğŸˆğŸ‰ğŸ¾ğŸ¥ğŸ³ğŸğŸ‘ğŸ’ğŸ¥ğŸ“ğŸ¸ğŸ¥ŠğŸ¥‹ğŸ¥…â›³â›¸ğŸ£ğŸ½ğŸ¿ğŸ›·ğŸ¥ŒğŸ¯ğŸ±ğŸ”®ğŸ§¿ğŸ®ğŸ•¹ğŸ°ğŸ²ğŸ§©ğŸ§¸â™ â™¥â™¦â™£â™ŸğŸƒğŸ€„ğŸ´ğŸ­ğŸ–¼ğŸ¨ğŸ§µğŸ§¶ğŸ”‡ğŸ”ˆğŸ”‰ğŸ”ŠğŸ“¢ğŸ“£ğŸ“¯ğŸ””ğŸ”•ğŸ¼ğŸµğŸ¶ğŸ™ğŸšğŸ›ğŸ¤ğŸ§ğŸ“»ğŸ·ğŸ¸ğŸ¹ğŸºğŸ»ğŸ¥ğŸ“±ğŸ“²â˜ğŸ“ğŸ“ŸğŸ“ ğŸ”‹ğŸ”ŒğŸ’»ğŸ–¥ğŸ–¨âŒ¨ğŸ–±ğŸ–²ğŸ’½ğŸ’¾ğŸ’¿ğŸ“€ğŸ§®ğŸ¥ğŸğŸ“½ğŸ¬ğŸ“ºğŸ“·ğŸ“¸ğŸ“¹ğŸ“¼ğŸ”ğŸ”ğŸ•¯ğŸ’¡ğŸ”¦ğŸ®ğŸ“”ğŸ“•ğŸ“–ğŸ“—ğŸ“˜ğŸ“™ğŸ“šğŸ““ğŸ“’ğŸ“ƒğŸ“œğŸ“„ğŸ“°ğŸ—ğŸ“‘ğŸ”–ğŸ·ğŸ’°ğŸ’´ğŸ’µğŸ’¶ğŸ’·ğŸ’¸ğŸ’³ğŸ§¾ğŸ’¹ğŸ’±ğŸ’²âœ‰ğŸ“§ğŸ“¨ğŸ“©ğŸ“¤ğŸ“¥ğŸ“¦ğŸ“«ğŸ“ªğŸ“¬ğŸ“­ğŸ“®ğŸ—³âœâœ’ğŸ–‹ğŸ–ŠğŸ–ŒğŸ–ğŸ“ğŸ’¼ğŸ“ğŸ“‚ğŸ—‚ğŸ“…ğŸ“†ğŸ—’ğŸ—“ğŸ“‡ğŸ“ˆğŸ“‰ğŸ“ŠğŸ“‹ğŸ“ŒğŸ“ğŸ“ğŸ–‡ğŸ“ğŸ“âœ‚ğŸ—ƒğŸ—„ğŸ—‘ğŸ”’ğŸ”“ğŸ”ğŸ”ğŸ”‘ğŸ—ğŸ”¨â›âš’ğŸ› ğŸ—¡âš”ğŸ”«ğŸ¹ğŸ›¡ğŸ”§ğŸ”©âš™ğŸ—œâš–ğŸ”—â›“ğŸ§°ğŸ§²âš—ğŸ§ªğŸ§«ğŸ§¬ğŸ”¬ğŸ”­ğŸ“¡ğŸ’‰ğŸ’ŠğŸšªğŸ›ğŸ›‹ğŸš½ğŸš¿ğŸ›ğŸ§´ğŸ§·ğŸ§¹ğŸ§ºğŸ§»ğŸ§¼ğŸ§½ğŸ§¯ğŸ›’ğŸš¬âš°âš±ğŸ—¿ğŸ§ğŸš®ğŸš°â™¿ğŸš¹ğŸšºğŸš»ğŸš¼ğŸš¾ğŸ›‚ğŸ›ƒğŸ›„ğŸ›…âš ğŸš¸â›”ğŸš«ğŸš³ğŸš­ğŸš¯ğŸš±ğŸš·ğŸ“µğŸ”â˜¢â˜£â¬†â†—â¡â†˜â¬‡â†™â¬…â†–â†•â†”â†©â†ªâ¤´â¤µğŸ”ƒğŸ”„ğŸ”™ğŸ”šğŸ”›ğŸ”œğŸ”ğŸ›âš›ğŸ•‰âœ¡â˜¸â˜¯âœâ˜¦â˜ªâ˜®ğŸ•ğŸ”¯â™ˆâ™‰â™Šâ™‹â™Œâ™â™â™â™â™‘â™’â™“â›ğŸ”€ğŸ”ğŸ”‚â–¶â©â­â¯â—€âªâ®ğŸ”¼â«ğŸ”½â¬â¸â¹âºâğŸ¦ğŸ”…ğŸ”†ğŸ“¶ğŸ“³ğŸ“´â™€â™‚âš•â™¾â™»âšœğŸ”±ğŸ“›ğŸ”°â­•âœ…â˜‘âœ”âœ–âŒââ•â–â—â°â¿ã€½âœ³âœ´â‡â€¼â‰â“â”â•â—ã€°Â©Â®â„¢ğŸ’¯ğŸ” ğŸ”¡ğŸ”¢ğŸ”£ğŸ”¤ğŸ”´ğŸ”µâšªâš«â¬œâ¬›]", str(text)))


def first_person_ratio(text):
    first_person_pronouns = ["ë‚˜", "ë‚´", "ì €", "ì €ëŠ”", "ì œê°€", "ì €ë„", "ë‚´ê°€"]
    words = okt.morphs(str(text))
    if not words:
        return 0
    count = sum(w in first_person_pronouns for w in words)
    return count / len(words)


def exclamation_question_ratio(text):
    text = str(text)
    if not text:
        return 0
    count = text.count("!") + text.count("?")
    return count / len(text)

def special_char_ratio(text):
    text = str(text)
    if not text:
        return 0
    count = len(re.findall(r"[~^]", text))
    return count / len(text)





# --- ë¶„ì„ í•¨ìˆ˜ -------------------------------------------------------------
def analyze_reviews(df):
    df["sponsored_keywords_count"] = df["text"].apply(lambda x: count_keywords_morph(x, sponsored_keywords))
    df["positive_bias_keywords"] = df["text"].apply(lambda x: count_keywords_morph(x, positive_keywords))
    df["external_links_count"] = df["text"].apply(count_external_links)
    df["shopping_mall_linked"] = df["text"].apply(has_shopping_mall_link)
    df["text_length"] = df["text"].apply(lambda x: len(str(x)))
    df["most_common_word_freq_ratio"] = df["text"].apply(count_most_common_word_freq_ratio)
    df["price_mentions"] = df["text"].apply(lambda x: count_keywords_morph(x, price_keywords))
    df["adj_adv_ratio"] = df["text"].apply(adj_adv_ratio)
    df["has_emoji"] = df["text"].apply(lambda x: int(emoji_count(x) > 0))
    df["first_person_ratio"] = df["text"].apply(first_person_ratio)
    df["exclamation_question_ratio"] = df["text"].apply(exclamation_question_ratio)
    df["special_char_ratio"] = df["text"].apply(special_char_ratio)




    return df

# --- ì‹¤í–‰ ---
def main():
    input_path = (R"C:\Users\lgrr-\Downloads\25ì¡¸í”„\ë°ì´í„° ëª¨ìœ¼ê¸°\feature\input.csv")
    output_path = "output.csv"

    df = pd.read_excel(input_path)
    df = pd.DataFrame(df.iloc[:, 0])
    df.columns = ["text"]


    df["image_count"] = 0

    df = analyze_reviews(df)
   
    df["is_ad"] = 0



    df.to_excel(output_path, index=False)
    print(f"ë¶„ì„ ì™„ë£Œ: {output_path}")

main()